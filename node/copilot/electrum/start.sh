#!/bin/sh

mkdir /log
## Redirecting Filehanders
ln -sf /proc/$$/fd/1 /log/stdout.log
ln -sf /proc/$$/fd/2 /log/stderr.log

mkdir -p /root/electrum_data/electrumx

export COIN='Garlicoin'
export DB_DIRECTORY='/root/electrum_data/electrumx'
export CACHE_MB='512'
export MAX_SESSIONS='100'
export DAEMON_URL=garlicoinrpc:TEyk_v3XXRVrh3gPqB3w5u8WWRgmMG_0yYAZcBF2dNc=@garlicoin-node.$COPILOT_ENVIRONMENT_NAME.$COPILOT_APPLICATION_NAME.local:42068/
echo "DAEMON_URL=$DAEMON_URL"
export ALLOW_ROOT='true'

export REPORT_SSL_PORT='50002'

export SERVICES=tcp://0.0.0.0:50001,ssl://0.0.0.0:50002,wss://0.0.0.0:50004,rpc://0.0.0.0:8000
export HOST=''

export PEER_DISCOVERY='on'
export PEER_ANNOUNCE='on'

export SSL_CERTFILE='-----BEGIN CERTIFICATE-----
MIIDJzCCAg8CFAI1YXz90irp/q0wW/S8A0ve+Eo4MA0GCSqGSIb3DQEBCwUAMFAx
CzAJBgNVBAYTAlVTMQswCQYDVQQIDAJOWTERMA8GA1UEBwwITmV3IFlvcmsxITAf
BgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDAeFw0yMjEyMDUwNjU4MTha
Fw0yNzEyMDQwNjU4MThaMFAxCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJOWTERMA8G
A1UEBwwITmV3IFlvcmsxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0
ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAJ1XViWEkYqSzfmEqKoY
J96/Sa0dpQvERElKPrHeRkg3aJkfW4p9Iy0Fi3m4TrMHZGDfi296td5G0NgWaNL+
7geqNeurd/4zEK/pH6AEbG7gfbLf7MJTs+KI7lEc+jYL4DqgdQwqlQUhDYtRVLZc
PxUMFUu3hn5EFCzye0vFoC8bZwb5Sxnr/stUIp97YRfr91tBgLbgMKBezEr/34Oo
5LnZbW7mcrjIl9JmZ1XpgFczK4ot0FEAXS7Z0GC5k5+ycOipQ0PGvqBwR81iYAvU
PdV1ZfmnsLgHzJ/qb6QCE0gnid/LJMlgzcl6/XEBP3q/OmfsSv7s7HmHKOVWXZVh
UMcCAwEAATANBgkqhkiG9w0BAQsFAAOCAQEAe0xGH2pYQnTkF6fG1vXu49SdylGJ
yAQonOU2KhQB+5zj2KlSqT6KLwTjf6wdY7orMVAZiqtrpVaRhkF8RZ2ICtDiz74R
p8VygzU+gzfW0NZbngsYHBNTwURB0aQO8me4/yaO75qptsPO8URCuuU8QaDjCEVi
OxIocX1dr8rgZlrtLrhEJ9AajFeKYtPQA3eM25k1lIVRE25cIu/m37aFu2BFL/Z2
FU//rCeFYlr3T3XuDtcBSZp3eNbFMF8YgPVaDiIJnAw1SJV6bvJgLcv4fdhHvuAH
jNvJRPA5WfbSl7CLo0Ofbnabx86j3xQN8lUjKfDxIujYaJUlO2qfNECSRQ==
-----END CERTIFICATE-----'
export SSL_KEYFILE='-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAnVdWJYSRipLN+YSoqhgn3r9JrR2lC8RESUo+sd5GSDdomR9b
in0jLQWLebhOswdkYN+Lb3q13kbQ2BZo0v7uB6o166t3/jMQr+kfoARsbuB9st/s
wlOz4ojuURz6NgvgOqB1DCqVBSENi1FUtlw/FQwVS7eGfkQULPJ7S8WgLxtnBvlL
Gev+y1Qin3thF+v3W0GAtuAwoF7MSv/fg6jkudltbuZyuMiX0mZnVemAVzMrii3Q
UQBdLtnQYLmTn7Jw6KlDQ8a+oHBHzWJgC9Q91XVl+aewuAfMn+pvpAITSCeJ38sk
yWDNyXr9cQE/er86Z+xK/uzseYco5VZdlWFQxwIDAQABAoIBAANil6Xi/kae9fOC
WSafsmvmba1dz+k65cU15bdp8tUm7AcvV4bZPmJ/lgqeXoMXi59R7+wMFdGccG3V
vZeciH59uP9DByfe7WL7fwSwU6znA41PqAZeSqZ7D7WLDA8RnldkkGAcomwj0+jF
bS8nOOw5AFRKtIgO6ug0p1ZwAAxDYAbo05CggzN4RSmEjl6yfc0lJeGObyNakfQb
FeLADL86qC9ixj4Edme04SntUx4BuMTuQx6xszdo8KHvfjVoBS4b2lwVAg7p1PCI
HRLTYhF8qTOYbCAaKZH1a22bV+wvEALNjnXVWmxph9lflQ4CZvIzrIaYejlqmZnK
t+4amRECgYEAzGG40jNsxwERBRHcmnvhEQHAB7BvyAWdNcsc27RlSYMw6RiG9322
N/rutd/xBYg2gSCvp8OyjOpzQu3L4VO30XcdYw7APURbdjQaLtIdWm+y4pMatdy+
YpwsnMGxULvC9VqEme5dZhJTINazD/oKlsaT7r5xW2Yh0ae5OQ2hWvUCgYEAxRQ2
OABDsocuTYYLu30FXMr9eUKo7eiEWKV2cYB6h19vnQWWBFi4PmdkpyWh3g/VTsmI
UQw/ThGJCpELcjlrFW8uGwthn4NRfJADRWPA5LEoD+G3hAVbRDpkm4Db66q3Vhaa
MaN9XfQrFRXeoTvPsyKA5dNdR2GuJLIeGdm4H0sCgYBnPxqRvX6/DU/ewsYxmFD7
OWobuErPvd5MNX4vkvLz7v0/U6+iyPPLVc1PPYDRbZ0zICL8WgUR4MI3Vk9/Vb5v
Z4AF8Ya1rJmTngB4FJbVf8XbZbrBknDu+bwjuElt4lw7e+2uoVa3YJxz42HzuTmu
L0S9/6DeLjr5YYRVSQhxHQKBgQCJGTlqlcyCaoXsij6pLBzJ47CXZacM8f73iAuw
g9c5S0vi6RrmZS2uw9CCcqx7RXp3d71r3GBBl/NEtYhH6ueynohtaep8xCawx6Ju
6CktLoyXF8fJgMxv10tb3jWfaUBnFAwqUfiJnq1F2tPoSCqCDJOszfALE0nI31wP
UaVDpwKBgQDAkAcL+TbA2fzumQeAU39qBc/HmVEe/DkbL8OaqqCjTQXReIzO7m7t
Mb1dH3tnLdAzjfvlsLjIxyHhPnyUBiX5eeqzMWpSmSMImT3jp/ESIP2o1nXnGTaY
sZxdZfaqVNCe+LLuA8VDy7TVX/ARxfa6EhV1XtkciVfqH40mpO8DpA==
-----END RSA PRIVATE KEY-----'

echo "$SERVER_CRT" > /root/server.crt
echo "$SERVER_KEY" > /root/server.key

# Start the electrum process
/usr/local/bin/electrumx_server